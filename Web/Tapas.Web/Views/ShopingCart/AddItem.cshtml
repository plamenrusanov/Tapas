@model Tapas.Web.ViewModels.ShopingCart.AddItemViewModel
@{
    ViewData["Title"] = "Index";
    var i = 1;
    decimal price = 0.0m;
}


<div class="container">
    <div class="row">
        <!--AddedProduct-->
        <div class="col-md-6">
            <div class="row">
                <img src="https://res.cloudinary.com/duxtyuzpy/image/upload/c_scale,h_270,w_400/v1587540009/@(Model.Product.ImageUrl)" alt="@Model.Product.Name">
            </div>
            <form asp-controller="ShopingCart" asp-action="AddItem">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="form-group">
                    @Html.HiddenFor(x => x.Product.Id, new { @class = "form-control" })
                    @Html.HiddenFor(x => x.ShopingCart.Id, new { @class = "form-control" })
                </div>
                <div class="row">
                    <h4>@Html.DisplayFor(x => x.Product.Name)</h4>
                </div>
                <div class="row">
                    <h4>@Html.DisplayFor(x => x.Product.Price) лв.</h4>
                </div>
                <div class="row">
                    @foreach (var item in Model.Product.Allergens)
                    {
                        <div class="col-md-1">
                            <img src="https://res.cloudinary.com/duxtyuzpy/image/upload/c_scale,h_45,w_45/v1587540009/@(item.ImageUrl)" alt="@item.Name">
                            <span>@Html.Label(item.Name)</span>
                        </div>
                    }
                </div>
                <div class="row form-group justify-content-around">
                    <div class="quantity buttons_added row">
                        <input id="minus" type="button" class="minus col-sm-4 form-control" value="◀">
                        <input asp-for="@Model.Quantity" id="theInput" type="text" size="4" class="form-control input-text qty text col-sm-4" title="Qty" value="1" min="1" step="1">
                        <input id="plus" type="button" class="plus col-sm-4 form-control justify-content-around" value="▶">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 form-group text-center">
                        <button type="submit" class="btn btn-primary btn-lg active">Добави</button>
                    </div>
                </div>
            </form>
        </div>
        <!--ShopingCart-->
        <div class="col-md-6">
            <h1 class="text-center">Твоята количка</h1>
            <hr class="hr-tapas" />
            <div class="bg-light">
                <table class="table justify-content-center">
                    <thead>
                        <tr class="row">
                            <th class="col-sm-1">
                                #
                            </th>
                            <th class="col-sm-3">
                                @Html.DisplayName("Продукт")
                            </th>
                            <th class="col-sm-3">
                                @Html.DisplayName("Количество")
                            </th>
                            <th class="col-sm-3">
                                @Html.DisplayName("Цена")
                            </th>
                            <th class="col-sm-2">
                                @Html.DisplayName("Actions")
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.ShopingCart.ShopingItems)
                        {
                            <tr class="row">
                                <td class="col-sm-1">
                                    @(i++)
                                </td>
                                <td class="col-sm-3">
                                    @Html.DisplayFor(x => item.ProductName)
                                </td>
                                <td class="col-sm-3">
                                    @Html.DisplayFor(x => item.Quantity)
                                </td>
                                <td class="col-sm-3">
                                    @{price = item.ProductPrice * item.Quantity; }
                                    @Html.DisplayFor(x => price)
                                </td>
                                <td class="col-sm-2">
                                    <a class="btn btn-danger btn-sm" href="/ShopingCart/DeleteProductItem?itemId=@item.Id&shopingCartId=@Model.ShopingCart.Id">Изтрий</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <hr class="hr-tapas" />
            

        </div>
    </div>
</div>
@section Scripts
{
    <script>
        var input = document.getElementById('theInput');
        document.getElementById('plus').onclick = function () {
            if (input.value < 10) {
                input.value = parseInt(input.value, 10) + 1
            }
        }
        document.getElementById('minus').onclick = function () {
            if (input.value > 1) {
                input.value = parseInt(input.value, 10) - 1
            }
        }
    </script>
}

